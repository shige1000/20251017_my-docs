# はじめに

ロードバランサー無しの環境をUPした時のサンプル
開発環境を想定
DNSサーバーは無し

## GCP設定値

### VPCネットワーク

| 項目 | 内容 |
| :--- | :--- |
| 名前 | vpc-dev |
| サブネット1・名前 | fe-dev-subnet |
| サブネット1・リージョン | asia-northeast1 |
| サブネット1・IPv4範囲 | 10.0.1.0/24 |
| サブネット1・プライベート Google アクセス | オン |
| サブネット1・フローログ | オフ（必要ならオン） |
| サブネット1・ハイブリッド サブネット | オフ |
| サブネット2・名前 | be-dev-subnet |
| サブネット2・リージョン | asia-northeast1 |
| サブネット2・IPv4範囲 | 10.0.2.0/24 |
| サブネット2・プライベート Google アクセス | オン |
| サブネット2・フローログ | オフ（必要ならオン） |
| サブネット2・ハイブリッド サブネット | オフ |
| ファイアウォールルール・全体 | サブネットのチェック全て |
| ファイアウォールルール・TCP | 22, 3000, 8000, 3306 |
| ファイアウォールルール・その他 | icmp（ip通信確認用） |
| 高度な動的ルーティング構成 | リージョン |
| 最適なパスの選択モード | レガシー |

### DB用

| 項目 | 内容 |
| :--- | :--- |
| データベースエンジン | MYSQL |
| エディション | Enterprise |
| エディションのプリセット | 本番 |
| データベースのバージョン | MySQL8.0 |
| インスタンスID | db-dev |
| パスワード | 記載しない |
| リージョン | asia-northeast1（東京） |
| ゾーンの可用性 | 複数のゾーン（高可用性） |
| マシンの構成 | 専用コア |
| 能力 | 1vCPU、3.75GB |
| ストレージ容量 | 30GB |
| 接続 | プライベートIP・パブリックIPどちらもチェック |
| ネットワーク | vpc-dev |
| プライベートIP・Service Networking・IP作成の種類 | 1 つ以上の既存の IP 範囲を選択するか、新しい IP 範囲を作成する |
| プライベートIP・Service Networking・名前 | db-dev-subnet |
| プライベートIP・Service Networking・割り当てられたIPアドレス範囲 | 10.0.3.0/24 |
| 参考予算 | 20250225-1時間あたり：0.19ドル |

インスタンス作成後、データベースタブからデータベースを作成する。

| 項目 | 内容 |
| :--- | :--- |
| 名前 | db_dev |
| 文字セット |utf8mb4 |
| 照合 | utf8mb4_0900_ai_ci |


### ファイアウォール

#### VPC内VMインスタンス表示用

| 項目 | 内容 |
| :--- | :--- |
| 名前 | vm-connection-in-vpc |
| 説明 | vpc内のvmのインスタンにssh接続する |
| ネットワーク | vpc-dev |
| ターゲット | 指定されたターゲットタグ |
| ターゲットタグ | fe-instance-tag, be-instance-tag |
| ソースフィルタ | IPv4 範囲 |
| 送信元IPv4範囲 | 35.235.240.0/20 |
| プロトコルとポート・TCP | 22 |

#### VPC内VMインスタンスのDocker表示用

| 項目 | 内容 |
| :--- | :--- |
| 名前 | vm-show-screen-in-vpc |
| 説明 | vpc内のvmのインスタンの画面を表示する |
| ネットワーク | vpc-dev |
| ターゲット | 指定されたターゲットタグ |
| ターゲットタグ | fe-instance-tag, be-instance-tag |
| ソースフィルタ | IPv4 範囲 |
| 送信元IPv4範囲 | 0.0.0.0/0 |
| プロトコルとポート・TCP | 3000,8000 |

### VMインスタンス

#### FE

| 大項目 | 項目 | 内容 |
| :--- | :--- | :--- |
| マシンの構成 | 名前 | fe-instance-dev |
| マシンの構成 | リージョン | asia-northeast1（東京） |
| マシンの構成 | ゾーン | asia-northeast1-a |
| OSとストレージ | マシンタイプ | e2-medium（2 vCPU, 1コア, 4GB メモリ） |
| OSとストレージ | ブートディスク | Debian GNU/Linux 12 (bookworm) |
| OSとストレージ | ブートディスクの種類 | バランス永続ディスク |
| OSとストレージ | ブートディスクサイズ | 30GB |
| ネットワーキング | HTTP トラフィックを許可 | ON |
| ネットワーキング | HTTPS トラフィックを許可 | ON |
| ネットワーキング | ロードバランサのヘルスチェックを許可 | ON |
| ネットワーキング | ネットワーキング タグ | fe-instance-tag |
| ネットワーキング | ネットワーク | vpc-dev |
| ネットワーキング | サブネット | fe-dev-subnet（10.0.1.0/24） |
| ネットワーキング | 外部IP | なし |
| ネットワーキング | IP スタックタイプ | IPv4（シングル スタック） |
| ネットワーキング | プライマリ内部 IPv4 アドレス | エフェメラル（自動） |
| ネットワーキング | 外部 IPv4 アドレス | あり |
| オブザーバビリティ | モニタリングとロギング用の Ops エージェントをインストールする | ON |
| セキュリティ | アクセススコープ | APIごとにアクセス権を設定 |
| セキュリティ | セキュアブートをオンにする | ON |
| 詳細 | 削除からの保護の有効化 | ON |
| 詳細 | 顧客管理の暗号鍵（CMEK）の取り消しポリシー | シャットダウン（推奨） |

#### BE

| 大項目 | 項目 | 内容 |
| :--- | :--- | :--- |
| マシンの構成 | 名前 | be-instance-dev |
| マシンの構成 | リージョン | asia-northeast1（東京） |
| マシンの構成 | ゾーン | asia-northeast1-a |
| OSとストレージ | マシンタイプ | e2-medium（2 vCPU, 1コア, 4GB メモリ） |
| OSとストレージ | ブートディスク | Debian GNU/Linux 12 (bookworm) |
| OSとストレージ | ブートディスクの種類 | バランス永続ディスク |
| OSとストレージ | ブートディスクサイズ | 30GB |
| ネットワーキング | HTTP トラフィックを許可 | ON |
| ネットワーキング | HTTPS トラフィックを許可 | ON |
| ネットワーキング | ロードバランサのヘルスチェックを許可 | ON |
| ネットワーキング | ネットワーキング タグ | be-instance-tag |
| ネットワーキング | ネットワーク | vpc-dev |
| ネットワーキング | サブネット | be-dev-subnet（10.0.2.0/24） |
| ネットワーキング | 外部IP | なし |
| ネットワーキング | IP スタックタイプ | IPv4（シングル スタック） |
| ネットワーキング | プライマリ内部 IPv4 アドレス | エフェメラル（自動） |
| ネットワーキング | 外部 IPv4 アドレス | あり |
| オブザーバビリティ | モニタリングとロギング用の Ops エージェントをインストールする | ON |
| セキュリティ | アクセススコープ | APIごとにアクセス権を設定 |
| セキュリティ | セキュアブートをオンにする | ON |
| 詳細 | 削除からの保護の有効化 | ON |
| 詳細 | 顧客管理の暗号鍵（CMEK）の取り消しポリシー | シャットダウン（推奨） |
